---
# User running the Authelia containers
service_authelia_user: "{{ baseline_config_admin_users[0].name }}"

# Base directory for Authelia files
service_authelia_base_dir: /opt/authelia

# Domain — REQUIRED, set in host/group vars
service_authelia_domain: ""

# Cookie domain (without leading dot)
service_authelia_cookie_domain: ""

# Container images — pin to specific versions
service_authelia_image: "docker.io/authelia/authelia:{{ authelia_version }}"
service_authelia_db_image: "docker.io/library/postgres:{{ postgres_version }}-alpine"
service_authelia_redis_image: "docker.io/library/redis:{{ redis_version }}-alpine"

# Database
service_authelia_db_name: authelia
service_authelia_db_user: authelia
service_authelia_db_password: "{{ vault_authelia_db_password }}"

# Secrets
service_authelia_jwt_secret: "{{ vault_authelia_jwt_secret }}"
service_authelia_session_secret: "{{ vault_authelia_session_secret }}"
service_authelia_storage_encryption_key: "{{ vault_authelia_storage_encryption_key }}"
service_authelia_oidc_hmac_secret: "{{ vault_authelia_oidc_hmac_secret }}"
service_authelia_oidc_jwks_private_key: "{{ vault_authelia_oidc_jwks_private_key }}"

# OIDC client secrets — plaintext for client apps, hashed for Authelia config
service_authelia_oidc_nextcloud_client_secret: "{{ vault_authelia_oidc_nextcloud_client_secret }}"
service_authelia_oidc_paperless_client_secret: "{{ vault_authelia_oidc_paperless_client_secret }}"
service_authelia_oidc_jitsi_client_secret: "{{ vault_authelia_oidc_jitsi_client_secret }}"
service_authelia_oidc_wordpress_client_secret: "{{ vault_authelia_oidc_wordpress_client_secret }}"

# OIDC client secret hashes (pbkdf2-sha512) — for Authelia configuration
service_authelia_oidc_nextcloud_client_secret_hash: "{{ vault_authelia_oidc_nextcloud_client_secret_hash }}"
service_authelia_oidc_paperless_client_secret_hash: "{{ vault_authelia_oidc_paperless_client_secret_hash }}"
service_authelia_oidc_jitsi_client_secret_hash: "{{ vault_authelia_oidc_jitsi_client_secret_hash }}"
service_authelia_oidc_wordpress_client_secret_hash: "{{ vault_authelia_oidc_wordpress_client_secret_hash }}"

# Service domains (for OIDC redirect URIs)
service_authelia_nextcloud_domain: "{{ service_nextcloud_domain }}"
service_authelia_paperless_domain: "{{ service_paperless_domain }}"
service_authelia_jitsi_domain: "{{ service_jitsi_domain }}"
service_authelia_wordpress_domain: "{{ service_wordpress_domain }}"

# Session timeouts
service_authelia_session_expiration: "2h"
service_authelia_session_inactivity: "15m"
service_authelia_session_remember_me: "24h"

# Brute-force regulation
service_authelia_regulation_max_retries: 3
service_authelia_regulation_find_time: "2m"
service_authelia_regulation_ban_time: "5m"

# Password policy (zxcvbn mode, score 0-4)
service_authelia_password_policy_min_score: 3

# OIDC token lifetimes
service_authelia_oidc_access_token_lifespan: "30m"
service_authelia_oidc_id_token_lifespan: "30m"
service_authelia_oidc_refresh_token_lifespan: "90m"

# Logging
service_authelia_log_format: "json"

# Redis authentication
service_authelia_redis_password: "{{ vault_authelia_redis_password }}"

# Authelia users — define in group_vars, passwords in vault
service_authelia_users: {}

# Podman network (shared with Caddy)
service_authelia_network: "{{ service_caddy_network }}"

# Caddy base directory for site config drop-in
service_authelia_caddy_base_dir: "{{ service_caddy_base_dir | default('/opt/caddy') }}"
